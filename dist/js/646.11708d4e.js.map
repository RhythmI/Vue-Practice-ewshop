{"version":3,"file":"js/646.11708d4e.js","mappings":"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","sources":["webpack://ewshop/./src/views/category/Category.vue","webpack://ewshop/./src/network/category.js","webpack://ewshop/./src/views/category/Category.vue?89fc"],"sourcesContent":["<template>\r\n  <div>\r\n\r\n    <nav-bar>\r\n      <template v-slot:default>商品分类</template>\r\n    </nav-bar>\r\n\r\n    <div id=\"mainbox\">\r\n\r\n      <div class=\"ordertab\">\r\n\r\n        <van-tabs v-model:active=\"activeTabs\" @click=\"tabClick\">\r\n          <van-tab title=\"销量排序\"></van-tab>\r\n          <van-tab title=\"价格排序\"></van-tab>\r\n          <van-tab title=\"评论排序\"></van-tab>\r\n        </van-tabs>\r\n\r\n\r\n      </div>\r\n\r\n      <div class=\"leftmenu\">\r\n\r\n        <van-collapse v-model=\"activeName\" accordion>\r\n          <van-collapse-item v-for=\"item in categories\"\r\n                             :key=\"item.id\"\r\n                             :title=\"item.name\"\r\n                             :name=\"item.id\">\r\n\r\n            <van-sidebar v-model=\"active\">\r\n              <van-sidebar-item v-for=\"sub in item.children\"\r\n                                :key=\"sub.id\"\r\n                                :title=\"sub.name\"\r\n                                @click=\"getGoods(sub.id)\"\r\n              />\r\n            </van-sidebar>\r\n\r\n          </van-collapse-item>\r\n        </van-collapse>\r\n\r\n      </div>\r\n\r\n      <div class=\"goodslist\">\r\n        <div class=\"content\">\r\n<!--          <van-card -->\r\n<!--              num=\"2\"-->\r\n<!--              tag=\"标签\"-->\r\n<!--              price=\"2.00\"-->\r\n<!--              desc=\"描述信息\"-->\r\n<!--              title=\"商品标题\"-->\r\n<!--              thumb=\"https://cdn.jsdelivr.net/npm/@vant/assets/ipad.jpeg\"-->\r\n<!--              origin-price=\"10.00\"-->\r\n<!--          />-->\r\n          <van-card v-for=\"item in showGoods\" :key=\"item.id\"\r\n              @click=\"itemClick(item.id)\"\r\n              :num=\"item.comments_count\"\r\n              :tag=\"item.comments_count >= 0 ? '流行' : '标签'\"\r\n              :price=\"item.price\"\r\n              :desc=\"item.updated_at\"\r\n              :title=\"item.title\"\r\n              :thumb=\"item.cover_url\"\r\n              origin-price=\"10.00\"\r\n              :lazy-load=\"true\"\r\n          />\r\n\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <back-top @bTop=\"bTop\" v-show=\"isShowBackTop\"></back-top>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport NavBar from \"components/common/navbar/NavBar\";\r\nimport {useRouter} from \"vue-router\";\r\nimport {ref, reactive, onMounted, computed} from \"vue\";\r\nimport {getCategory, getCategoryGoods} from \"@/network/category\";\r\nimport BScroll from 'better-scroll'\r\nimport BackTop from \"@/components/common/backtop/BackTop\";\r\nimport {getHomeGoods} from \"@/network/home\";\r\nimport {nextTick, watchEffect} from \"vue\";\r\n\r\n\r\nexport default {\r\n  name: \"Category\",\r\n  components:{\r\n    NavBar,\r\n    BackTop,\r\n  },\r\n  setup(){\r\n    let activeTabs = ref(0);\r\n    let active = ref(0);\r\n    let activeName = ref(1);\r\n\r\n    let categories = ref([]);\r\n\r\n    // 当前的排序条件\r\n    let currentOrder = ref('sales');\r\n    // 当前的分类id\r\n    let currentCid = ref(0);\r\n\r\n    // 上拉加载更多\r\n    let bscroll = reactive({});\r\n\r\n    let isShowBackTop = ref(false);\r\n\r\n    const router = useRouter();\r\n\r\n    // 数据模型\r\n    const goods = reactive({\r\n      sales:{page:1, list:[]},\r\n      price:{page:1, list:[]},\r\n      comments_count:{page:1, list:[]},\r\n    })\r\n\r\n    const showGoods = computed(()=>{\r\n      return goods[currentOrder.value].list;\r\n    })\r\n\r\n    const init = ()=>{\r\n      getCategoryGoods('sales', currentCid.value).then(res=>{\r\n        goods.sales.list = res.goods.data;\r\n        console.log(res.goods.data);\r\n      })\r\n    }\r\n\r\n\r\n\r\n    onMounted(()=>{\r\n      getCategory().then(res=>{\r\n        // console.log(res);\r\n        categories.value = res.categories;\r\n\r\n        init();\r\n\r\n        // 创建BetterScroll对象\r\n        bscroll = new BScroll(document.querySelector('.goodslist'), {\r\n          probeType:3,  // 0,1,2,3   3:只要在运动就触发scroll事件\r\n          click: true,  // 是否允许点击\r\n          pullUpLoad: true,  // 上拉加载更多，默认是false\r\n        });\r\n\r\n\r\n        // 注册滚动事件\r\n        bscroll.on('scroll', (position)=>{\r\n          isShowBackTop.value = (-position.y) > 300\r\n        })\r\n\r\n        // 上拉加载数据，触发pullingUp\r\n        bscroll.on('pullingUp', ()=>{\r\n          console.log('上拉加载更多。。。');\r\n\r\n\r\n          const page = goods[currentOrder.value].page + 1;\r\n          getCategoryGoods(currentOrder.value, currentCid.value, page).then(res=>{\r\n            goods[currentOrder.value].list.push(...res.goods.data);\r\n\r\n            goods[currentOrder.value].page += 1;\r\n\r\n          })\r\n\r\n\r\n\r\n          // 完成上拉，等数据请求完成，要将新数据展示出来\r\n          bscroll.finishPullUp();\r\n\r\n\r\n          // 重新计算高度\r\n          bscroll.refresh();\r\n          console.log('contentHeight'+document.querySelector('.content').clientHeight);\r\n          console.log(\"当前类型\" + currentOrder.value + \", 当前页：\" + page);\r\n        })\r\n\r\n\r\n\r\n      })\r\n    })\r\n\r\n    // 排序选项卡\r\n    const tabClick = (index) =>{\r\n      // console.log(\"排序的序号：\" + index);\r\n      let orders = ['sales', 'price', 'comments_count'];\r\n      currentOrder.value = orders[index];\r\n\r\n      getCategoryGoods(currentOrder.value, currentCid.value).then(res=>{\r\n        goods[currentOrder.value].list = res.goods.data;\r\n\r\n        nextTick(()=>{\r\n          // 重新计算高度\r\n          bscroll && bscroll.refresh();\r\n        })\r\n\r\n\r\n      })\r\n\r\n      console.log(currentCid.value);\r\n      console.log(\"排序的序号：\" + orders[index]);\r\n    }\r\n\r\n    // 通过分类get商品\r\n    const getGoods = (cid) =>{\r\n      currentCid.value = cid;\r\n\r\n      getCategoryGoods(currentOrder.value, currentCid.value).then(res=>{\r\n        goods[currentOrder.value].list = res.goods.data;\r\n      })\r\n\r\n      console.log(cid);\r\n      console.log(\"排序的序号：\" + currentOrder.value);\r\n    }\r\n\r\n\r\n    // // 监听  任何一个变量有变化就会触发\r\n    // watchEffect(()=>{\r\n    //   nextTick(()=>{\r\n    //     // 重新计算高度\r\n    //     bscroll && bscroll.refresh();\r\n    //   })\r\n    // })\r\n\r\n    const bTop = () =>{\r\n      bscroll.scrollTo(0, 0, 300);\r\n    }\r\n\r\n\r\n    return{\r\n      activeTabs,\r\n      active,\r\n      activeName,\r\n      categories,\r\n      tabClick,\r\n      currentOrder,\r\n      currentCid,\r\n      getGoods,\r\n      goods,\r\n      showGoods,\r\n      bscroll,\r\n      isShowBackTop,\r\n      bTop,\r\n      itemClick: (id)=>{\r\n        router.push({path:'/detail', query:{id}})\r\n      },\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n#mainbox{\r\n\r\n  margin-top: 45px;\r\n  display: flex;\r\n\r\n  .ordertab{\r\n    flex: 1;\r\n    float: right;\r\n    //background: red;\r\n    //width: 100%;\r\n    height: 50px;\r\n    z-index: 9;\r\n    position: fixed;\r\n    top: 45px;\r\n    right: 0;\r\n    left: 130px;\r\n  }\r\n\r\n  .leftmenu{\r\n    position: fixed;\r\n    top: 95px;\r\n    left: 0;\r\n    //background: green;\r\n    width: 130px;\r\n    //height: 200px;\r\n  }\r\n\r\n  .goodslist{\r\n    flex: 1;\r\n    //background: blue;\r\n    position: absolute;\r\n    top: 100px;\r\n    left: 130px;\r\n    right: 0;\r\n    height: 100vh;\r\n    padding: 10px;\r\n\r\n  }\r\n\r\n}\r\n\r\n\r\n</style>","import {request} from \"./request\";\r\n\r\nexport function getCategory(){\r\n    return request({\r\n        url: '/api/goods',\r\n        method: 'get',\r\n        // params: {}\r\n    })\r\n}\r\n\r\nexport function getCategoryGoods(order=\"sales\", cid=0, page=1){\r\n    return request({\r\n        url: '/api/goods?category_id='+cid+'&page='+page+'&'+order+'=1',\r\n        method: 'get',\r\n        // params: {}\r\n    })\r\n}","import { render } from \"./Category.vue?vue&type=template&id=2e3cb1ac&scoped=true\"\nimport script from \"./Category.vue?vue&type=script&lang=js\"\nexport * from \"./Category.vue?vue&type=script&lang=js\"\n\nimport \"./Category.vue?vue&type=style&index=0&id=2e3cb1ac&scoped=true&lang=scss\"\n\nimport exportComponent from \"D:\\\\1Master\\\\work\\\\前端\\\\Vue高洛峰\\\\myproject\\\\vueproject\\\\ewshop\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2e3cb1ac\"]])\n\nexport default __exports__"],"names":["id","class","_createElementBlock","_createVNode","_component_nav_bar","default","_createElementVNode","_component_van_tabs","active","$setup","$event","onClick","_component_van_tab","title","_component_van_collapse","accordion","_Fragment","_renderList","item","_createBlock","_component_van_collapse_item","key","name","_component_van_sidebar","children","sub","_component_van_sidebar_item","_component_van_card","num","comments_count","tag","price","desc","updated_at","thumb","cover_url","_component_back_top","onBTop","getCategory","request","url","method","getCategoryGoods","order","cid","page","components","NavBar","BackTop","setup","activeTabs","ref","activeName","categories","currentOrder","currentCid","bscroll","reactive","isShowBackTop","router","useRouter","goods","sales","list","showGoods","computed","value","init","then","res","data","console","log","onMounted","BScroll","document","querySelector","probeType","click","pullUpLoad","on","position","y","push","finishPullUp","refresh","clientHeight","tabClick","index","orders","nextTick","getGoods","bTop","scrollTo","itemClick","path","query","__exports__","render"],"sourceRoot":""}