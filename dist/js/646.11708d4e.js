"use strict";(self["webpackChunkewshop"]=self["webpackChunkewshop"]||[]).push([[646],{2554:function(e,l,o){o.r(l),o.d(l,{default:function(){return y}});var t=o(6252),a=o(9963);const i=(0,t.Uk)("商品分类"),n={id:"mainbox"},c={class:"ordertab"},s={class:"leftmenu"},u={class:"goodslist"},d={class:"content"};function r(e,l,o,r,p,v){const g=(0,t.up)("nav-bar"),m=(0,t.up)("van-tab"),h=(0,t.up)("van-tabs"),b=(0,t.up)("van-sidebar-item"),k=(0,t.up)("van-sidebar"),w=(0,t.up)("van-collapse-item"),_=(0,t.up)("van-collapse"),f=(0,t.up)("van-card"),C=(0,t.up)("back-top");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[i])),_:1}),(0,t._)("div",n,[(0,t._)("div",c,[(0,t.Wm)(h,{active:r.activeTabs,"onUpdate:active":l[0]||(l[0]=e=>r.activeTabs=e),onClick:r.tabClick},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{title:"销量排序"}),(0,t.Wm)(m,{title:"价格排序"}),(0,t.Wm)(m,{title:"评论排序"})])),_:1},8,["active","onClick"])]),(0,t._)("div",s,[(0,t.Wm)(_,{modelValue:r.activeName,"onUpdate:modelValue":l[2]||(l[2]=e=>r.activeName=e),accordion:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(r.categories,(e=>((0,t.wg)(),(0,t.j4)(w,{key:e.id,title:e.name,name:e.id},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{modelValue:r.active,"onUpdate:modelValue":l[1]||(l[1]=e=>r.active=e)},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.children,(e=>((0,t.wg)(),(0,t.j4)(b,{key:e.id,title:e.name,onClick:l=>r.getGoods(e.id)},null,8,["title","onClick"])))),128))])),_:2},1032,["modelValue"])])),_:2},1032,["title","name"])))),128))])),_:1},8,["modelValue"])]),(0,t._)("div",u,[(0,t._)("div",d,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(r.showGoods,(e=>((0,t.wg)(),(0,t.j4)(f,{key:e.id,onClick:l=>r.itemClick(e.id),num:e.comments_count,tag:e.comments_count>=0?"流行":"标签",price:e.price,desc:e.updated_at,title:e.title,thumb:e.cover_url,"origin-price":"10.00","lazy-load":!0},null,8,["onClick","num","tag","price","desc","title","thumb"])))),128))])])]),(0,t.wy)((0,t.Wm)(C,{onBTop:r.bTop},null,8,["onBTop"]),[[a.F8,r.isShowBackTop]])])}var p=o(3080),v=o(2119),g=o(2262),m=o(7707);function h(){return(0,m.W)({url:"/api/goods",method:"get"})}function b(e="sales",l=0,o=1){return(0,m.W)({url:"/api/goods?category_id="+l+"&page="+o+"&"+e+"=1",method:"get"})}var k=o(5109),w=o(2840),_=(o(1492),{name:"Category",components:{NavBar:p.Z,BackTop:w.Z},setup(){let e=(0,g.iH)(0),l=(0,g.iH)(0),o=(0,g.iH)(1),a=(0,g.iH)([]),i=(0,g.iH)("sales"),n=(0,g.iH)(0),c=(0,g.qj)({}),s=(0,g.iH)(!1);const u=(0,v.tv)(),d=(0,g.qj)({sales:{page:1,list:[]},price:{page:1,list:[]},comments_count:{page:1,list:[]}}),r=(0,t.Fl)((()=>d[i.value].list)),p=()=>{b("sales",n.value).then((e=>{d.sales.list=e.goods.data,console.log(e.goods.data)}))};(0,t.bv)((()=>{h().then((e=>{a.value=e.categories,p(),c=new k.ZP(document.querySelector(".goodslist"),{probeType:3,click:!0,pullUpLoad:!0}),c.on("scroll",(e=>{s.value=-e.y>300})),c.on("pullingUp",(()=>{console.log("上拉加载更多。。。");const e=d[i.value].page+1;b(i.value,n.value,e).then((e=>{d[i.value].list.push(...e.goods.data),d[i.value].page+=1})),c.finishPullUp(),c.refresh(),console.log("contentHeight"+document.querySelector(".content").clientHeight),console.log("当前类型"+i.value+", 当前页："+e)}))}))}));const m=e=>{let l=["sales","price","comments_count"];i.value=l[e],b(i.value,n.value).then((e=>{d[i.value].list=e.goods.data,(0,t.Y3)((()=>{c&&c.refresh()}))})),console.log(n.value),console.log("排序的序号："+l[e])},w=e=>{n.value=e,b(i.value,n.value).then((e=>{d[i.value].list=e.goods.data})),console.log(e),console.log("排序的序号："+i.value)},_=()=>{c.scrollTo(0,0,300)};return{activeTabs:e,active:l,activeName:o,categories:a,tabClick:m,currentOrder:i,currentCid:n,getGoods:w,goods:d,showGoods:r,bscroll:c,isShowBackTop:s,bTop:_,itemClick:e=>{u.push({path:"/detail",query:{id:e}})}}}}),f=o(3744);const C=(0,f.Z)(_,[["render",r],["__scopeId","data-v-2e3cb1ac"]]);var y=C}}]);
//# sourceMappingURL=646.11708d4e.js.map